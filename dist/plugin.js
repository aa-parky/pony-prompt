(()=>{"use strict";var t={156:function(t,n,e){var o=this&&this.__createBinding||(Object.create?function(t,n,e,o){void 0===o&&(o=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,o,r)}:function(t,n,e,o){void 0===o&&(o=e),t[o]=n[e]}),r=this&&this.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)"default"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&o(n,t,e);return r(n,t),n},l=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(r,i){function l(t){try{s(o.next(t))}catch(t){i(t)}}function a(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(l,a)}s((o=o.apply(t,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.init=n.info=void 0;const a=i(e(896)),s=i(e(928)),c=["01_faces","02_clothing","03_posture","04_b","05_p","06_actions"];function u(t){const n=function(t){try{let n="";try{n=a.readFileSync(t,"utf-8")}catch(e){console.warn(`[PonyPlugin] Failed to read ${t} as utf-8, trying latin1...`),n=a.readFileSync(t,"latin1")}return n.split(/\r?\n/).map((t=>t.trim())).filter((t=>t.includes("=")))}catch(n){return console.warn(`[PonyPlugin] Error reading file ${t}:`,n),[]}}(t);if(0===n.length)return null;const e=n[Math.floor(Math.random()*n.length)],o=e.split("=",2);return o.length>1?"string"==typeof o[1]?o[1].trim():(console.warn(`[PonyPlugin] Unexpected non-string value for parts[1] in file ${t}, line: "${e}". parts[1] is:`,o[1]),null):null}n.info={id:"pony-prompt",name:"Pony Prompt Generator",description:"Generates prompt components for Pony Diffusion from local text files.",version:"1.0.0",author:"Your Name",website:"",tags:["text-generation","utility"]},n.init=function(t){return l(this,void 0,void 0,(function*(){return console.log("[PonyPlugin] Initializing Pony Prompt Generator plugin (full logic)..."),t.post("/generate",((t,n)=>{try{const e=t.body.user_text||"";console.log(`[PonyPlugin] Received user_text: "${e}"`);const o=function(t,n){const e=[];for(const o of n){const n=s.join(t,o);try{if(a.existsSync(n)&&a.statSync(n).isDirectory()){const t=a.readdirSync(n).filter((t=>t.endsWith(".txt")));if(t.length>0){const o=t[Math.floor(Math.random()*t.length)],r=u(s.join(n,o));null!==r&&""!==r.trim()&&e.push(r.trim())}}else console.warn(`[PonyPlugin] Directory not found or not a directory: ${n}`)}catch(t){console.warn(`[PonyPlugin] Error processing directory ${n}:`,t.message)}}return e}("/home/aapark/development/comfy-managed/input/00_pony",c);let r=e.trim();o.length>0&&(r.length>0&&(r+=" "),r+=o.join(", ")),r.trim().length>0?r=`/imagine ${r.trim()}`:0===e.trim().length&&0===o.length&&console.log("[PonyPlugin] No user text and no components generated. Returning empty prompt."),console.log(`[PonyPlugin] Generated full_prompt: "${r}"`),n.json({full_prompt:r})}catch(t){console.error("[PonyPlugin] Error in /generate endpoint:",t.message,t.stack),n.status(500).json({error:"Internal server error while generating prompt."})}})),console.log("[PonyPlugin] Pony Prompt Generator plugin initialized with POST /generate endpoint (full logic)."),Promise.resolve()}))}},896:t=>{t.exports=require("fs")},928:t=>{t.exports=require("path")}},n={};var e=function e(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={exports:{}};return t[o].call(i.exports,i,i.exports,e),i.exports}(156);module.exports=e})();